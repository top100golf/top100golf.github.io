---
title: "Prolific designers"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(lubridate)
library(gridExtra)
library(png)
source("/Users/skipperry/Documents/golf_course_rankings/plot_rankings.R")
source("/Users/skipperry/Documents/golf_course_rankings/course_categories.R")
```

```{r}
current_rankings <- 
  all_rankings %>% 
  group_by(Publication) %>% 
  filter(Year == max(Year)) %>% 
  ungroup() %>% 
  select(Ranking, Course, Publication) %>% 
  spread(Publication, Ranking) %>% 
  mutate(Average = (`Golf Digest` + `Golf Magazine`) / 2) %>% 
  inner_join(course_info, by = "Course") %>% 
  mutate(
    Designer1 = if_else(Designer1 == "Robert Trent Jones", "Robert Trent Jones Sr.", Designer1),
    Designer2 = if_else(Designer2 == "Robert Trent Jones", "Robert Trent Jones Sr.", Designer2),
    Designer3 = if_else(Designer3 == "Robert Trent Jones", "Robert Trent Jones Sr.", Designer3)
  ) %>% 
  transmute(
    Course, Location = str_c(City, ", ", State), 
    Designers = case_when(
      is.na(Designer2) ~ Designer1,
      is.na(Designer3) ~ str_c(Designer1, Designer2, sep = ", "),
      TRUE ~ str_c(Designer1, Designer2, Designer3, sep = ", ")
    ),
    `Year Designed` = Year_Designed, `Golf Digest`, `Golf Magazine`, Average,
    Top_Rating = case_when(
      is.na(`Golf Digest`) | `Golf Digest` > `Golf Magazine` ~ `Golf Magazine`,
      TRUE ~ `Golf Digest`
    )
  ) %>% 
  arrange(Average, Top_Rating) %>% 
  select(-Top_Rating) %>% 
  rename(`Golf Digest Current` = `Golf Digest`, `Golf Magazine Current` = `Golf Magazine`,
         `Average Current` = `Average`)

best_rankings <- 
  all_rankings %>% 
  group_by(Course, Publication) %>% 
  filter(Ranking == min(Ranking)) %>% 
  slice(1) %>% 
  ungroup() %>% 
  select(Ranking, Course, Publication) %>% 
  spread(Publication, Ranking) %>% 
  mutate(Average = (`Golf Digest` + `Golf Magazine`) / 2) %>% 
  inner_join(course_info, by = "Course") %>% 
  mutate(
    Designer1 = if_else(Designer1 == "Robert Trent Jones", "Robert Trent Jones Sr.", Designer1),
    Designer2 = if_else(Designer2 == "Robert Trent Jones", "Robert Trent Jones Sr.", Designer2),
    Designer3 = if_else(Designer3 == "Robert Trent Jones", "Robert Trent Jones Sr.", Designer3)
  )  %>% 
  transmute(
    Course, Location = str_c(City, ", ", State), 
    Designers = case_when(
      is.na(Designer2) ~ Designer1,
      is.na(Designer3) ~ str_c(Designer1, Designer2, sep = ", "),
      TRUE ~ str_c(Designer1, Designer2, Designer3, sep = ", ")
    ),
    `Year Designed` = Year_Designed, `Golf Digest`, `Golf Magazine`, Average,
    Top_Rating = case_when(
      is.na(`Golf Digest`) | `Golf Digest` > `Golf Magazine` ~ `Golf Magazine`,
      TRUE ~ `Golf Digest`
    )
  ) %>% 
  arrange(Average, Top_Rating) %>% 
  select(-Top_Rating) %>% 
  rename(`Golf Digest Best` = `Golf Digest`, `Golf Magazine Best` = `Golf Magazine`,
         `Average Best` = `Average`)

course_listing_for_designers <- 
  current_rankings %>% 
  full_join(best_rankings, by = c("Course", "Location", "Designers", "Year Designed")) %>% 
  mutate(across(where(is.numeric), ~ if_else(is.na(.), '-', as.character(.))))
```

```{r}
prolific_designers <- 
  course_info %>% 
  select(Course, Designer1, Designer2, Designer3) %>% 
  mutate(
    Designer1 = if_else(Designer1 == "Robert Trent Jones", "Robert Trent Jones Sr.", Designer1),
    Designer2 = if_else(Designer2 == "Robert Trent Jones", "Robert Trent Jones Sr.", Designer2),
    Designer3 = if_else(Designer3 == "Robert Trent Jones", "Robert Trent Jones Sr.", Designer3)
  )  %>% 
  pivot_longer(Designer1:Designer3, names_to = "key", values_to = "Designer") %>% 
  filter(!is.na(Designer)) %>% 
  inner_join(course_listing_for_designers %>% select(Course), by = "Course") %>% 
  group_by(Designer) %>% 
  count(sort = TRUE) %>% 
  ungroup() %>% 
  pull(Designer)
```

```{r, include=FALSE}
prolific_designers[1:20]
```

```{r}
doi_total <- function(designer_of_interest) {
  course_listing_for_designers %>% 
    filter(str_detect(Designers, designer_of_interest)) %>% 
    count() %>% 
    pull(n)
}
doi_current <- function(designer_of_interest) {
  course_listing_for_designers %>% 
    filter(str_detect(Designers, designer_of_interest)) %>% 
    filter(`Golf Digest Current` != "-" | `Golf Magazine Current` != "-") %>% 
    count() %>% 
    pull(n)
}
doi_former <- function(designer_of_interest) {
  course_listing_for_designers %>% 
    filter(str_detect(Designers, designer_of_interest)) %>% 
    filter(`Golf Digest Current` == "-" & `Golf Magazine Current` == "-") %>% 
    count() %>% 
    pull(n)
}
doi_course_table <- function(designer_of_interest) {
  base_url <- "https://top100golf.github.io/"

  course_listing_for_designers %>% 
    filter(str_detect(Designers, designer_of_interest)) %>% 
    select(-Designers, -contains("Average")) %>% 
    mutate(Course = str_c("[", Course, "](", base_url, str_replace_all(Course, "\\(|\\)|\\s|\\'", "-"), ".html)")) %>% 
    knitr::kable(align = "c")
}
doi_photo <- function(designer_of_interest) {
  designer_img_path <- 
    str_c(
      "designers/", 
      designer_of_interest, 
      ".png"
    )
  knitr::include_graphics(designer_img_path)
}
?include_graphics
```

```{r, out.width = 150}
designer_of_interest <- "Tom Fazio"
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```


```{r, out.width = 150}
designer_of_interest <- "Jack Nicklaus"
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```


```{r, out.width = 150}
designer_of_interest <- "Donald Ross"
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```


```{r, out.width = 150}
designer_of_interest <- "Robert Trent Jones Sr."
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```


```{r, out.width = 150}
designer_of_interest <- "Pete Dye"
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```


```{r, out.width = 150}
designer_of_interest <- "A.W. Tillinghast"
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```


```{r, out.width = 150}
designer_of_interest <- "Seth Raynor"
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```


```{r, out.width = 150}
designer_of_interest <- "Dick Wilson"
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```


```{r, out.width = 150}
designer_of_interest <- "Bill Coore"
designer_of_interest %>% doi_photo()
"Ben Crenshaw" %>% doi_photo()
```

### Bill Coore & Ben Crenshaw
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```


```{r, out.width = 150}
designer_of_interest <- prolific_designers[11]
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```



```{r, out.width = 150}
designer_of_interest <- prolific_designers[12]
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```



```{r, out.width = 150}
designer_of_interest <- prolific_designers[13]
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```



```{r, out.width = 150}
designer_of_interest <- prolific_designers[14]
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```



```{r, out.width = 150}
designer_of_interest <- prolific_designers[15]
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```



```{r, out.width = 150}
designer_of_interest <- prolific_designers[16]
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```



```{r, out.width = 150}
designer_of_interest <- prolific_designers[17]
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```



```{r, out.width = 150}
designer_of_interest <- prolific_designers[18]
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```



```{r, out.width = 150}
designer_of_interest <- prolific_designers[19]
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```



```{r, out.width = 150}
designer_of_interest <- prolific_designers[20]
designer_of_interest %>% doi_photo()
```

### `r designer_of_interest`
#### `r designer_of_interest %>% doi_total()` courses (`r designer_of_interest %>% doi_current` current, `r designer_of_interest %>% doi_former` previous)

```{r}
designer_of_interest %>% doi_course_table()
```